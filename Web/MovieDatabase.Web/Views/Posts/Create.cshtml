@model MovieDatabase.Web.ViewModels.Posts.CreatePostVM

@{
    this.ViewData["Title"] = "New post";
}

<div class="page-intro">
    <h2>New post</h2>
</div>

<form class="form-custom" method="Post" asp-controller="Posts" asp-action="Create" id="add-post-form">
    <div class="panel panel-white col-xs-12">
        <div class="panel-body">

            <div class="form-group row">
                <div class="col-xs-12">
                    <div class="md-input">
                        <label for="name" class="md-input-placeholder">Post title</label>
                        <input asp-for="Name" class="md-input-control">
                    </div>
                    <span asp-validation-for="Name" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-2x mt-2x">
                <div class="section-heading col-xs-12">Movie</div>
            </div>

            <div class="form-group row">
                <div class="col-xs-12">
                    <div class="md-input">
                        <label for="Movie.Name" class="md-input-placeholder">Title</label>
                        <input asp-for="Movie.Name" class="md-input-control">
                    </div>
                    <span asp-validation-for="Movie.Name" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-xs-12">
                    <div class="md-input">
                        <label for="Movie.Name" class="md-input-placeholder">Description</label>
                        <textarea asp-for="Movie.Description" class="md-input-control form-control"></textarea>
                    </div>
                    <span asp-validation-for="Movie.Description" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-2x mt-2x">
                <div class="section-heading col-xs-12 text-center">Cast</div>
            </div>

            <div class="row">
                <div class="col-xs-12 col-md-6">Actor</div>
                <div class="col-xs-12 col-md-6">Character</div>
            </div>

            <div class="form-group row cast">
                <div class="col-xs-12 col-md-6">
                    <div class="md-input">
                        <input type="text" class="md-input-control typeahead">
                    </div>
                    <span asp-validation-for="Movie.MovieActors[0].Id" class="text-danger"></span>
                </div>
                <div class="col-xs-12 col-md-6">
                    <div class="md-input movie-actor">
                        <input asp-for="Movie.MovieActors[0].CharacterName" class="md-input-control character-name">
                        <input hidden asp-for="Movie.MovieActors[0].Id" class="actor-id" />
                    </div>
                    <span asp-validation-for="Movie.MovieActors[0].CharacterName" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group row ">
                <div class="col-xs-12">
                    <button type="button" class="btn btn-secondary btn-waves" id="actor-add-btn"><i class="fa fa-plus"></i> Add actor</button>
                    <button type="button" class="btn btn-danger btn-waves hidden" id="actor-remove-btn"><i class="fa fa-minus"></i> Remove actor</button>
                </div>
            </div>

            <div class="row mb-2x mt-2x">
                <div class="section-heading col-xs-12">Awards</div>
            </div>

            <div class="form-group row award">
                <div class="col-xs-12">
                    <div class="md-input">
                        <input asp-for="Movie.Awards[0]" class="md-input-control award-name">
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-xs-12">
                    <button type="button" class="btn btn-secondary btn-waves" id="award-add-btn"><i class="fa fa-plus"></i> Add award</button>
                    <button type="button" class="btn btn-danger btn-waves hidden" id="award-remove-btn"><i class="fa fa-minus"></i> Remove award</button>
                </div>
            </div>

            <div class="form-group row mt-2x">
                <div class="text-center">
                    <button type="submit" class="btn btn-waves btn-primary waves-effect waves-light">
                        Add post
                    </button>
                </div>
            </div>

        </div>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <environment names="Development,Staging,Production">
        <script src="~/lib/typeahead/typeahead.bundle.js"></script>
        <script src="~/js/posts/create-post.js"></script>
    </environment>
    <script>
        (function (movieDbApp) {
            movieDbApp.createPostConfig = {
                getActorsUrl: '@Url.Action("GetActors", "Actors", new { name = Html.Raw("QUERY") })',
                actorHtml: {
                    characterNameInput: '@Html.TextBoxFor(m => m.Movie.MovieActors[-111].CharacterName, new { @class = "md-input-control character-name" })',
                    actorIdInput: '@Html.HiddenFor(m=>m.Movie.MovieActors[-111].Id, new{ @class= "actor-id" })',
                    characterNameValidation: '@Html.ValidationMessageFor(m=>m.Movie.MovieActors[-111].CharacterName, null, new {@class="text-danger" })'
                },
                awardHtml: {
                    awardInput: '@Html.TextBoxFor(m => m.Movie.Awards[-111], new { @class = "md-input-control" })'
                }
            }

            movieDbApp.init();
        })(window.movieDbApp);

    </script>
}